/*! soma-interact - v0.0.1 - Romuald Quantin - 2012-11-27
* http://soundstep.github.com/soma-interact/
* MIT licence 2012 */
(function(e,t){"use strict";function h(t,n){var r;if(isString(t)){if(!isElement(n))throw new Error(e.template.errors.TEMPLATE_STRING_NO_ELEMENT);n.innerHTML=t,r=n}else{if(!isElement(t))throw new Error(e.template.errors.TEMPLATE_NO_PARAM);isElement(n)?(n.innerHTML=t.innerHTML,r=n):r=t}p(r)&&(p(r).dispose(),templates.remove(r));var i=new Template(r);return templates.put(r,i),i}function p(e){return isElement(e)?templates.get(e):null}function d(){for(var e in templates.getData())templates.get(e).render()}function v(e){e===null&&(s={},o={});if(isDefined(e)&&isObject(e))for(var t in e)e.hasOwnProperty(t)&&(s[t]=o[t]=e[t]);return s}function m(t,n){t.constructor.prototype.createTemplate=function(t,n){if(!t||typeof t!="function")throw new Error("Error creating a template, the first parameter must be a function.");if(n&&isElement(n)){var r=e.template.create(n);for(var i in r)typeof r[i]=="function"&&(t.prototype[i]=r[i].bind(r));t.prototype.render=r.render.bind(r);var s=this.injector.createChild();return s.mapValue("template",r),s.mapValue("scope",r.scope),s.mapValue("element",r.element),s.createInstance(t)}return null},e.template.bootstrap=function(e,n,r){t.createTemplate(r,n)}}e.template=e.template||{},e.template.version="0.0.6";var n=e.template.errors={TEMPLATE_STRING_NO_ELEMENT:"Error in soma.template, a string template requirement a second parameter: an element target - soma.template.create('string', element)",TEMPLATE_NO_PARAM:"Error in soma.template, a template requires at least 1 parameter - soma.template.create(element)"},r="{{",i="}}",s={},o={},u=e.template.settings=e.template.settings||{};u.autocreate=!0;var a=u.tokens={start:function(e){return isDefined(e)&&e!==""&&(r=escapeRegExp(e),setRegEX(e,!0)),r},end:function(e){return isDefined(e)&&e!==""&&(i=escapeRegExp(e),setRegEX(e,!1)),i}},f=u.attributes={skip:"data-skip",repeat:"data-repeat",src:"data-src",href:"data-href",show:"data-show",hide:"data-hide",cloak:"data-cloak",checked:"data-checked",disabled:"data-disabled",multiple:"data-multiple",readonly:"data-readonly",selected:"data-selected",template:"data-template"},l=u.vars={index:"$index",key:"$key"},c={sequence:null,token:null,expression:null,escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,trim:/^[\s+]+|[\s+]+$/g,repeat:/(.*)\s+in\s+(.*)/,func:/(.*)\((.*)\)/,params:/,\s+|,|\s+,\s+/,quote:/\"|\'/g,content:/[^.|^\s]/gm,depth:/..\//g,string:/^(\"|\')(.*)(\"|\')$/};a.start(r),a.end(i),e.plugins=e.plugins||{},e.plugins&&e.plugins.add&&e.plugins.add(m),e.template.create=h,e.template.get=p,e.template.renderAll=d,e.template.helpers=v,e.template.bootstrap=bootstrapTemplate,typeof define=="function"&&define.amd&&define("soma-template",e.template),typeof exports!="undefined"&&(typeof module!="undefined"&&module.exports&&(exports=module.exports=e.template),exports=e.template)})(this.soma=this.soma||{});